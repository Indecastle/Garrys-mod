@name glass
@persist RangerLength Count E:entity
if(first()){
    
    RangerLength = 500
    Count = 8  # 80
    
    for(I = 0, Count) {
        holoCreate(I)
        holoColor(I, hsv2rgb(10*I, 1, 1))
    }
    
    E = entity()
}

local StartPos = E:pos()
local StartDir = E:up()

for(I = 0, Count) {
    rangerFilter(players())
    local R = rangerOffset(StartPos,StartPos + StartDir * RangerLength) 
    local DirVec = (R:pos() - StartPos):normalized()
    holoPos(I, StartPos + StartDir * R:distance() / 2)
    holoAng(I, StartDir:toAngle())
    holoScaleUnits(I, vec(R:distance(), 0.5, 0.5))
    local RN = R:hitNormal()
    StartDir = DirVec - 2 * RN * RN:dot(DirVec)
    StartPos = R:pos()
}


interval(100)
